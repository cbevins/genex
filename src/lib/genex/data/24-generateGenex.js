import fs from 'fs'
import { Auditor } from '../genex/Auditor.js'
import { Genex } from '../genex/Genex.js'
import { PersonInfo } from '../genex/PersonInfo.js'

const time1 = new Date()
const progName = (process.argv[1]).split('\\').pop()
const infoName = '_personInfo'
const infoFile = `./diagnostics/genex/${infoName}.txt`

const genex = new Genex()
const time2 = new Date()

let lines = []
for(let i=0; i<genex.people().length; i++) {
    const person = genex.people()[i]
    const info = new PersonInfo(person)
    lines = lines.concat(info.getLines())
}
const time3 = new Date()

// Write Genex _peopleInfo file
const head = `// auto-generated by ${progName} on ${new Date().toLocaleString()}\n`
let js = head + lines.join('\n')
fs.writeFile(infoFile, js, function (err) { if (err) throw err })

console.log(`\n${progName}`)
console.log(`    1 - created Genex with ${genex.people().length} Person and ${genex.family().length} Family instances.`)
console.log(`    2 - wrote ${lines.length} Genex Person info lines into '${infoFile}'.`)
console.log(`        Genex creation time      ${time2-time1} msec`)
console.log(`        PersonInfo creation time ${time3-time2} msec`)
console.log(`        File writing time        ${new Date()-time3} msec`)
console.log(`        Total Processing Time    ${new Date()-time1} msec`)
